<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1">
        <title>ws-test</title>
	</head>
    
    <script>


        fetch('http://localhost:3000/create', {
            method: 'POST'
        })
        .then(res => res.json())
        .then(res => {
            console.log(res);

            let socket = new WebSocket('ws://localhost:3000'); 
            socket.onopen = () => {
                socket.send(JSON.stringify({
                    id: res.id
                }));

                socket.send(JSON.stringify({
                    id: 'bad_id'
                }));
            };

            socket.onmessage = (m) => console.log('MESSAGE', m);
            socket.onclose = () => console.log('CLOSE');
            socket.onerror = () => console.log('ERROR');
        });

    </script>

    <body>
        test
    </body>
</html>